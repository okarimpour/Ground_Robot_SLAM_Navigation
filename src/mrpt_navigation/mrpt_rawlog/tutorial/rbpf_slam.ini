//------------------------------------------------------------
// Config file for the "RBPF-SLAM" application
//
// Optimal sampling algorithm: 3: pfAuxiliaryPFOptimal
//
//              ~ The MRPT Library ~
//          Jose Luis Blanco Claraco ï¿½ 2005-2007
//------------------------------------------------------------


//=======================================================
// Section: [MappingApplication]
// Use: Here comes global parameters for the app.
//=======================================================
[MappingApplication]
// The source file (RAW-LOG) with action/observation pairs
rawlog_file=
rawlog_offset=2

// The directory where the log files will be saved (left in blank if no log is required)
logOutput_dir=LOG_RBPF
LOG_FREQUENCY=5			// The frequency of log files generation:
GENERATE_LOG_JOINT_H=0
GENERATE_LOG_INFO=0
SAVE_MAP_IMAGES=1
SAVE_3D_SCENE=0
SAVE_POSE_LOG=0                         /// TODO funktioniert nicht!!!
SAVE_ENOSE_READINGS=0
CAMERA_3DSCENE_FOLLOWS_ROBOT=0
SHOW_PROGRESS_IN_WINDOW=1
SHOW_PROGRESS_IN_WINDOW_DELAY_MS=0;

// Insertion thresholds
insertionLinDistance= 1.00 		// The distance threshold for inserting observations in the map (meters)
insertionAngDistance_deg= 15.0		// The angular distance threshold for inserting observations in the map (degrees)

// Localization thresholds
localizeLinDistance	 = 0.25	  	// The distance threshold for updating the RBPF (meters)
localizeAngDistance_deg  = 5.0	// The angular distance threshold for updating the RBPF (degrees)

//----------------------------------------------------------------------------------
// MAP INITIALIZATION
//----------------------------------------------------------------------------------
// Map initialization with points map
ENABLE_INIT_POINTS_MAP=0
POINTS_MAP_FILE=rbpf-slam-init-map.txt
ENABLE_POINTS_MAP_UPDATE=0		// enable updating of points-map

// Map initialization with simple-map
ENABLE_INIT_GRID_MAP=0
SIMPLE_MAP_FILE=../../plsLoc/resources/map10l.simplemap
INIT_POSE_X=0 //1.508244 		// Start point is at the end point of the loaded map, otherwise change here	
INIT_POSE_Y=0 //0.067417
INIT_POSE_PHI=0 //5.384981		// angle in degree

//----------------------------------------------------------------------------------
// The Particle Filter algorithm:
// 	0: pfStandardProposal		=> Sequential importance resampling => for accurate odometry and any map
//	1: pfAuxiliaryPFStandard	=> 
//	2: pfOptimalProposal      *** (ICP,...)
//	3: pfAuxiliaryPFOptimal	  *** (Optimal SAMPLING)
//
// See: /docs/html/topic_pf.html  or http://mrpt.sourceforge.net/topic_pf.html
//----------------------------------------------------------------------------------
PF_algorithm=3
adaptiveSampleSize=1			// 0: Fixed # of particles, 1: KLD adaptive

//----------------------------------------------------------------------------------
// The Particle Filter Resampling method:
//	0: prMultinomial
//	1: prResidual
//	2: prStratified
//	3: prSystematic
//
// See: /docs/html/topic_resampling.html or http://mrpt.sourceforge.net/topic_resampling.html
//----------------------------------------------------------------------------------
resamplingMethod=0

sampleSize=10 // 20			// Sample size (for fixed number)
BETA=0.50				// Resampling ESS threshold

max_loglikelihood_dyn_range  = 20


// ====================================================
//
//            MULTIMETRIC MAP CONFIGURATION
//
// ====================================================
// Creation of maps:
occupancyGrid_count=1
gasGrid_count=0
landmarksMap_count=0
beaconMap_count=0
pointsMap_count=0

// Selection of map for likelihood: (fuseAll=-1,occGrid=0, points=1,landmarks=2,gasGrid=3)
likelihoodMapSelection=-1

// ====================================================
//         CHybridMetricMapPDF::TPredictionParams
// ====================================================
powFactor=0.01					// A "power factor" for updating weights: weight*=lik^powFactor
pfAuxFilterOptimal_MaximumSearchSamples=600	// For PF algorithm=3


// -----------------------------------------------------------------
//   pfOptimalProposal_mapSelection
//  Only for PF algorithm=2 (Exact "pfOptimalProposal")
//   Select the map on which to calculate the optimal 
//    proposal distribution. Values:
//   0: Gridmap   -> Uses Scan matching-based approximation (based on Stachniss' work)
//   1: Landmarks -> Uses matching to approximate optimal
//   2: Beacons   -> Used for exact optimal proposal in RO-SLAM
//   3: Points-map-> Uses Scan matching-based approximation (based on Stachniss' work)
// -----------------------------------------------------------------
pfOptimalProposal_mapSelection=0

// Adaptive sample size parameters ------------------
KLD_maxSampleSize=150
KLD_minSampleSize=15
KLD_binSize_XY=0.03
KLD_binSize_PHI_deg=1
KLD_delta=0.001
KLD_epsilon=0.5


// ====================================================
//   MULTIMETRIC MAP: OccGrid #00
// ====================================================
// Creation Options for OccupancyGridMap 00:
[MappingApplication_occupancyGrid_00_creationOpts]
resolution= 0.04
disableSaveAs3DObject=0


// Insertion Options for OccupancyGridMap 00:
[MappingApplication_occupancyGrid_00_insertOpts]
mapAltitude=0
useMapAltitude=0
maxDistanceInsertion=30
maxOccupancyUpdateCertainty=0.54
considerInvalidRangesAsFreeSpace=0
minLaserScanNoiseStd=0.01
wideningBeamsWithDistance = 1
decimation = 1


// Likelihood Options for OccupancyGridMap 00:
[MappingApplication_occupancyGrid_00_likelihoodOpts]
likelihoodMethod=4		// 0=MI, 1=Beam Model, 2=RSLC, 3=Cells Difs, 4=LF_Trun, 5=LF_II
LF_decimation=4
LF_stdHit=0.05
LF_maxCorrsDistance=0.50
LF_zHit=0.999
LF_zRandom=0.001
LF_maxRange=30
LF_alternateAverageMethod=0

enableLikelihoodCache=1

